import { Component, OnInit } from '@angular/core';
import { CarsService } from 'src/app/_services/cars.service';
import { AccountService } from 'src/app/_services/account.service';
import { User } from 'src/app/_models/user';
import { take } from 'rxjs/operators';
import { Car } from 'src/app/_models/car';
import { ToastrService } from 'ngx-toastr';
import { Observable } from 'rxjs';
import { AudiMark, BMWMark, MarkEnum, MercedesBenzMark } from 'src/app/_enums/cars-data';

@Component({
  selector: 'app-car-card',
  templateUrl: './car-card.component.html',
  styleUrls: ['./car-card.component.css'],
})
export class CarCardComponent implements OnInit {
  user: User;
  cars$: Observable <Car[]>; 
  car: Car;
  public Marks = MarkEnum;
  public MercedesModels = MercedesBenzMark;
  public BMWModels: BMWMark;
  public AudiMark = AudiMark;

  enumKeys = [];
  carModels = [];

  constructor(private _accoutService: AccountService, private _carsService: CarsService, private _toastr: ToastrService) { 
    this._accoutService.currentUser$.pipe(take(1)).subscribe(user => this.user = user);
    this.enumKeys = Object.keys(this.Marks).filter(f => !isNaN(Number(f)));
  }

  ngOnInit(): void {
    this.cars$ = this._carsService.getCars();
  }
  addUserCar(){
    this._carsService.addUserCar(this.car);
  }
  readUserCar(){
    this.cars$ = this._carsService.getCars();
  }
  deleteUserCar(id: Number){
    console.log("lalalalala");
    this._carsService.deleteUserCar(id);
  }
  onSelect(MarkEnum)
  {
    console.log(MarkEnum);
    switch(MarkEnum)
    {
      case "0": this.carModels = Object.values(this.AudiMark); break;
      case "1": this.carModels = Object.values(this.MercedesModels); break;
    }    
  }
}
